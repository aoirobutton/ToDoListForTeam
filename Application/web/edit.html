<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>作業更新</title>
        <link rel="STYLESHEET" href="css/todo.css" type="text/css">
        <script type="text/javascript" src="dwr/engine.js"></script>
        <script type="text/javascript" src="dwr/util.js"></script>
        <script type="text/javascript" src="dwr/interface/AddTicketController.js"></script>
        <script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>

<script type="text/javascript">
        ticket=new Array();
        window.onload = function onLoad() {
        getP();
        console.log(ticket["ticket"]);

        AddTicketController.getAccountList({
                    callback: function (accountList) {
                var list = "";
                list = list + '<tr>';
                list = list + '<th class="add_field">' + "担当者" + '</th>';
                list = list + '<td class="add_field">';
                list = list + '<select name="responsible" size="1">';
                for (var i in accountList) {
                    account = accountList[i];
                    if (i == 0) {
                        list = list + '<option value="' + account.user + '" selected>' + account.user + '</option>';
                    } else {
                        list = list + '<option value="' + account.user + '">' + account.user + '</option>';
                    }
                }
                list = list + '</select>';
                list = list + '</td>';
                list = list + '</tr>';
                //document.write(list);
                console.log(list);
                $("#userList").html(list);
                $("#ticket").html(ticket["ticket"])
                $("#project").html(ticket["project"])
                console.log(accountList);
            }
        });
    }
        function getP(){
                /* アドレスの「?」以降の引数(パラメータ)を取得 */
                 var pram=location.search;
                /* 引数がない時は処理しない */
                if (!pram) return false;
                /* 先頭の?をカット */
                pram=pram.substring(1);
                /* 「&」で引数を分割して配列に */
                var pair=pram.split("&");
                var i=temp="";
                for (i=0; i < pair.length; i++) {
                    /* 配列の値を「=」で分割 */
                    temp=pair[i].split("=");
                    ticketName=temp[0];
                    ticketValue=temp[1];
                    /* キーと値の連想配列を生成 */
                    ticket[ticketName]=ticketValue;
                }
        }
    </script>
    </head>
    <body>
        <h1>作業更新</h1>
        <hr>
        <div align="center">
            <div id = "url.ticket"></div>
            <table border="0">
                <form action="list.html">
                    <tr>
                        <th class="add_field">
                            項目名
                        </th>
                        <td class="add_field" id="ticket">
                            <input type="text" name="name" value="" size="24">                            
                    <tbody id="thisticket"></tbody>
                        <!--td class="add_field">
                            <div id="thisticket">
                        </td-->
                    </tr>
                        <tbody id="userList">
                        </tbody>
<!-- comment out>
                        <tr>
                        <th class="add_field">
                            担当者
                        </th>
<!-- comment out>
                        <td class="add_field">
                            <select name="user_id" size="1">
                                <option value="user1_id" selected>ユーザ1</option>
                                <option value="user2_id">ユーザ2</option>
                            </select>
                        </td>
                    </tr>
<comment out -->
                    <tr>
                        <th class="add_field">
                            期限
                        </th>
                        <td class="add_field">
                            <input type="text" name="year" value="" size="8">/<input type="text" name="month" value="" size="4">/<input type="text" name="day" value="" size="4">
                        </td>
                    </tr>
                    <tr>
                        <th class="add_field">
                            プロジェクト名
                        </th>
                        <td class="add_field" id="project">
                            <input type="text" name="name" value="" size="24">
                        </td>
                    </tr>
                    <tr>
                        <th class="add_field">
                            状態
                        </th>
                        <td class="add_field">
                            <select name="user_id" size="1">
                                <option value="ToDo" selected>ToDo</option>
                                <option value="Doing">Doing</option>
                                <option value="Done">Done</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" class="add_button">
                            <table border="0">
                                <tr>
                                    <td>
                                        <input type="submit" value="更新">
                                    </td>
                                    </form>
                                    <form action="all.html">
                                    <td>
                                        <input type="submit" value="キャンセル">
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </form>
            </table>
        </div>
    </body>
</html>

